@page "{id?}"
@model BlogPostModel

<article>

    @if (Model.BlogPosts.Count() == 1)
    {
        var blogPost = Model.BlogPosts.First();

        <h1>@Model.Title</h1>

        <partial name="~/Pages/Partials/_Image.cshtml" model="@blogPost.Image" />

        <div class="content">

            @if (blogPost.Categories?.Any() == true)
            {
                <p class="blogpost-categories">
                    @foreach (var category in blogPost.Categories.OrderBy(_ => _.Title))
                    {
                        <a asp-page="Category" asp-route-id="@category.Slug">@category.Title</a>
                    }
                </p>
            }

            <p class="blogpost-intro">
                @blogPost.Intro
            </p>

            @Html.Raw(blogPost.Body)
            
            <p>
                Published:<br />
                <time>@blogPost.PublishedAt?.ToString("f")</time>
            </p>
            <p>
                Created:<br />
                <time>@blogPost.CreatedAt?.ToString("f")</time>
            </p>
            <p>
                Last updated:<br />
                <time>@blogPost.UpdatedAt?.ToString("f")</time>
            </p>

            <partial name="~/Pages/Partials/_Form.cshtml" model="@blogPost.TypeformFormId" />

            <p><a asp-page="BlogPost" asp-route-id="">All blog posts →</a></p>

        </div>

    }
    else if (Model.BlogPosts.Count() > 1)
    {
        <h1>Blog posts</h1>

        <partial name="~/Pages/Partials/_BlogPosts.cshtml" model="@Model.BlogPosts" />

        <environment include="Development">
            <partial name="~/Pages/Partials/_BlogPosts.cshtml" model="@Model.BlogPosts" />
            <partial name="~/Pages/Partials/_BlogPosts.cshtml" model="@Model.BlogPosts" />
            <partial name="~/Pages/Partials/_BlogPosts.cshtml" model="@Model.BlogPosts" />
            <partial name="~/Pages/Partials/_BlogPosts.cshtml" model="@Model.BlogPosts" />
        </environment>
    }
    else if (!string.IsNullOrEmpty(Model.Id))
    {
        <h1>Sorry, couldn't find any blog posts with id "@Model.Id"</h1>
    }
    else
    {
        <h1>Sorry, couldn't find any blog posts</h1>
    }

</article>
